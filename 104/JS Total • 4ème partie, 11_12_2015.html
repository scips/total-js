<!DOCTYPE html>
<!-- saved from url=(0055)http://delicious-insights.com/js-total/jst-day4/#/intro -->
<html lang="fr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>JS Total • 4ème partie, 11/12/2015</title>

    <meta name="author" content="Christophe Porteneuve">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="./JS Total • 4ème partie, 11_12_2015_files/reveal.min.css">
    <link rel="stylesheet" href="./JS Total • 4ème partie, 11_12_2015_files/js-attitude.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="./JS Total • 4ème partie, 11_12_2015_files/tomorrow.css">

    <!-- If the query includes 'print-pdf', use the PDF print sheet -->
    <script>
      if (window.location.search.match( /print-pdf/gi))
        document.write( '<link rel="stylesheet" href="css/print/pdf.css" type="text/css" media="all">' );
      else
        document.write( '<link rel="stylesheet" href="css/print/paper.css" type="text/css" media="print">' );;
    </script><link rel="stylesheet" href="./JS Total • 4ème partie, 11_12_2015_files/paper.css" type="text/css" media="print">

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>

  <body class="no-anims">

    <div class="reveal default center" data-transition-speed="default" data-background-transition="default">

      <!-- Used to fade in a background when a specific slide state is reached -->
      <div class="state-background"></div>

      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides" style="width: 960px; height: 700px; zoom: 1;">
        <section id="intro" class="present" style="top: -216px; display: block;">
          <h1>JS Total</h1>
          <h3 data-marker="intro-date">4ème partie, 11/12/2015</h3>
          <h4 data-marker="intro-trainers">Jean-Pierre Vincent @ JS Attitude</h4>
          <script>
            // Delicously hacky. Look away.
            if( navigator.userAgent.match( /(iPhone|iPad|iPod|Android)/i ) ) document.write( '<p style="color: rgba(0,0,0,0.3); text-shadow: none;">('+'Tap to navigate'+')</p>' );
          </script>
        </section>

        <section id="overview" hidden="" class="future" style="top: -163.5px; display: block;">
          <h1>JS Total</h1>
          <h4 data-marker="overview-dates">4 journées du 8 au 11 décembre</h4>

          <p><span data-marker="day4">Aujourd’hui</span>&nbsp;: industrialisation et web mobile</p>
        </section>

        <section id="testing" hidden="" class="stack future" style="top: 0px; display: block;">
          <section class="chapter" style="top: -137px; display: block;">
            <h1>Tester</h1>
            <h4>Ce qui vaut pour le back, vaut pour le front</h4>

            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>Tranquilité du développeur, qualité finale du produit</p>
<p>tests unitaires (fonction par fonction) VS tests d'intégration / fonctionnels (scénario complet)</p>
<p>TDD :</p>
<ul>
<li>bug = 1 test, la correction après</li>
<li>dev : lire la spec, écrire le test, passer les tests</li>
</ul>
<p>difficultés supposées : asynchronisme, navigateurs</p>
<p>pas de souci technique : c'est culturel. Mais le Web a maintenant besoin de qualité</p>
<p>Sinon, Jasmine, Mocha, Selenium, PhantomJS, casperJS</p>
</aside>
          </section>

          <section id="testing-mocha" class="future" style="top: -291.5px; display: block;">
            <h1>Mocha</h1>

            <p>Universel, issu de Node, particulièrement fort pour tester les aspects <strong>asynchrones</strong></p>
            <p>Système d’assertions libre (délégué)</p>
            <p>Contextes imbriqués, before/after classiques</p>
            <p>Facilités de ciblage temporaire (inclusif/exclusif)</p>
            <p>Et plein d’autres trucs bien&nbsp;!</p>
            <p><a href="http://mochajs.org/">visionmedia.github.com/mocha</a></p>

            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>Dérouler l'ensemble de la page officielle.</p>
<ul>
<li>assertion au choix (shoot.js, expect.js (jasmine), chai)</li>
<li>asynchrone : un callback avec .done() et il comprend</li>
<li>pendings tests</li>
<li>test duration : plus de 50 ms = warning de lenteur. plus de 100 = erreur</li>
<li>fait pour Node, mais peut aussi marcher dans browser</li>
<li>grosse liste de reporter (dont html, json, tap et surtout spec</li>
<li>à la base fait pour la ligne de commande en Node, mais on va le faire marcher dans un navigateur</li>
</ul>
</aside>
          </section>

          <section id="mocha-ui" class="future" style="top: -20px; display: none;">
            <h1>Mocha&nbsp;: BDD</h1>

            <pre><code data-trim="" data-noescape="" class="javascript" data-file="test/collection_spec.js"><u>describe</u>(<span class="string">'The collection'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
  <u>before</u>(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span> … });     <span class="comment">// Avant l'ensemble du `describe`</span>

  <u>beforeEach</u>(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span> … }); <span class="comment">// Avant chaque `it`</span>

  <span class="comment">// Et aussi&nbsp;: `after`, `afterEach`</span>

  <u>it</u>(<span class="string">'should maintain the natural order'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="comment">// Setup du test et assertions ici</span>
  });
});</code></pre>

            <pre><code data-trim="" data-noescape="" class="no-highlight"><span class="prompt">$ mocha test/collection_spec.js</span>

  The collection
    <span class="green">✓</span> <span class="gray">should maintain the natural order</span>

  <span class="green">1 passing</span> <span class="gray">(27ms)</span></code></pre>
            <aside class="notes" data-markdown="" data-markdown-parsed="true"><ul>
<li>montrer package.json</li>
<li><ul>
<li>dans devDependancies les packages de test</li>
</ul>
</li>
<li><ul>
<li>le npm run testing (marche sur win ?)</li>
</ul>
</li>
<li>créer le rep test/ (RACINE)</li>
<li>créer test/collection_spec.js</li>
<li>copier / coller depuis la slide</li>
<li>mettre use strict, config jsHint : globals describe,before …</li>
<li>before : init de chai.should()</li>
<li>rappeler qu'on veut tester l'ordre naturel de la collection : montrer models/collection.js et son comparator</li>
<li>montrer npm test d'abord puis npm run testing</li>
<li>beforeEach : require models/collection + instance coll en variable de la portée d'au dessus</li>
<li>faire trouver l'algo du test</li>
<li><p>après que le test passe, bien tester que le test fail en commentant comparator dans models/collection</p>
</li>
<li><p>démos de pending : <code>it('attend une implémentation');</code></p>
</li>
<li>démo asynchrone + vitesse d'exécution moyenne, rapide, lente, timeout</li>
</ul>
<pre><code class="javascript">it(<span class="string">'doit aller vite'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(done)</span> {</span>
  <span class="comment">// timeout de ce test</span>
  <span class="keyword">this</span>.timeout(<span class="number">1000</span>);
  <span class="comment">// appel de done pour dire ok c'est fini</span>
  setTimeout(done, <span class="number">50</span>); <span class="comment">// 20 = rapide, 50 = moyen, 80 = lent</span>
});</code></pre>
<ul>
<li>Couverture de test : démo possible avec un <code>npm run test-cov</code></li>
<li><ul>
<li>montrer test-reports/coverage.json et reports/lcov-report.index.html</li>
</ul>
</li>
<li><ul>
<li>provient de Istanbul, on peut montrer package.json =&gt; scripts =&gt; test-cov</li>
</ul>
</li>
</ul>
</aside>
          </section>

          <section id="chai" class="future" style="top: -20px; display: none;">
            <h1><a href="http://chaijs.com/">Chai</a></h1>

            <p>Assertions riches (+ tonnes de plugins) &amp; choix de style</p>

            <table class="table lines rightLabels">
              <thead>
                <tr>
                  <th><a href="http://chaijs.com/guide/styles/">Syntaxe</a></th>
                  <th>Exemples</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Assert</td>
                  <td>
                    <pre><code data-trim="" data-noescape="" class="javascript">assert.typeOf(foo, <span class="string">'string'</span>, <span class="string">'foo is a string'</span>);
assert.equal(foo, <span class="string">'bar'</span>, <span class="string">'foo equal `bar`'</span>);
assert.lengthOf(foo, <span class="number">3</span>, <span class="string">'foo`s value has a length of 3'</span>);
assert.lengthOf(beverages.tea, <span class="number">3</span>, <span class="string">'beverages has 3 types of tea'</span>);</code></pre>
                  </td>
                </tr>
                <tr>
                  <td>Expect</td>
                  <td>
                    <pre><code data-trim="" data-noescape="" class="javascript">expect(foo).to.be.a(<span class="string">'string'</span>);
expect(foo).to.equal(<span class="string">'bar'</span>);
expect(foo).to.have.length(<span class="number">3</span>);
expect(beverages).to.have.property(<span class="string">'tea'</span>).<span class="keyword">with</span>.length(<span class="number">3</span>);</code></pre>
                  </td>
                </tr>
                <tr>
                  <td><strong>Should</strong></td>
                  <td>
                    <pre><code data-trim="" data-noescape="" class="javascript">foo.should.be.a(<span class="string">'string'</span>);
foo.should.equal(<span class="string">'bar'</span>);
foo.should.have.length(<span class="number">3</span>);
beverages.should.have.property(<span class="string">'tea'</span>).<span class="keyword">with</span>.length(<span class="number">3</span>);</code></pre>
                  </td>
                </tr>
              </tbody>
            </table>
          </section>

          <section id="testing-sinon" class="future" style="top: -20px; display: none;">
            <h1>sinon.js</h1>
            <h4>De qui se moque-t-on&nbsp;?</h4>

            <p><strong>Attention&nbsp;: tuerie</strong></p>
            <p>Outil de spies/mocks/stubs hyper bien foutu</p>
            <p>Mocke carrément Ajax, les APIs REST et le temps&nbsp;!</p>
            <p>Indispensable pour découpler le code testé de ses dépendances externes, ce qui est une bonne pratique incontournable en unitaire/fonctionnel.</p>
            <p><a href="http://sinonjs.org/">sinonjs.org</a></p>

            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>Recommandé pour toute situation de mocking, quel que soit le contexte/harnais.  Éviter notamment la fonctionnalité similaire intégrée à Jasmine, qui est carrément pourrie (clock pas configurable par ex…, stub et spy).</p>
<p>Bien montrer, au travers de la page officielle, la hiérarchie spy -&gt; stub -&gt; mock</p>
<ul>
<li>spy : log tous les appels à une fonction (this, arguments, return, timestamps…). Ne touche pas à la fonctionnalité</li>
<li>stub : remplace la méthode d'origine. Genre $.ajax</li>
<li>Mock : composé de stubs, pour simuler une API complète</li>
<li>fake timers : pour tester animations, timeouts, horloges… Remplace setTimeout, setInterval, clear, Date …</li>
<li>fake XHR mais encore mieux le fake server* pour définir comment un serveur XHR doit répondre</li>
</ul>
</aside>
          </section>

          <section id="sinon-timers" class="future" style="top: -20px; display: none;">
            <h1>Maître du temps</h1>
            <p>Sinon permet de prendre la main sur toute la gestion du temps*</p>

            <pre><code data-trim="" data-noescape="" class="javascript" data-file="test/persistence_spec.js"><span class="keyword">var</span> clock = sinon.<u>useFakeTimers</u>(); <span class="comment">// Gel du temps</span>
<span class="comment">// …</span>
clock.<u>tick(<span class="number">1</span>)</u>;
<span class="comment">// …</span>
clock.<u>restore</u>();</code></pre>

            <pre><code data-trim="" data-noescape="" class="javascript" data-file="test-phantomjs/home_view_spec.js">clock = sinon.useFakeTimers(<u><span class="number">1412507461204</span></u>); <span class="comment">// Reset à un moment donné + gel</span>
<span class="comment">// …</span>
clock.tick(<span class="number">1000</span>);
<span class="comment">// …</span>
clock.restore();</code></pre>

            <footer>*
              <code>new Date</code>, <code>Date.now()</code>,
              <code>setTimeout</code>, <code>clearTimeout</code>,
              <code>setInterval</code>, <code>clearInterval</code>,
              <code>setImmediate</code>, <code>clearImmediate</code>
            </footer>

            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>But 1 : vérifier que nos clés sont bien uniques (à la milliseconde près en tout cas)</p>
<ul>
<li>remontrer qu'on avait créé lib/persistence.js/@addCheckIn . Ainsi que getCheckIns</li>
<li>créer persistence\_spec.js , copier depuis collection\_spec . On peut supprimer beforeEach, on ne garde qu'un seul it()</li>
<li>algo : <strong>ajouter 2 checkins à 1 milliseconde d'intervalle et vérifier que les keys sont séparées d'une milliseconde</strong></li>
<li>récupérer lib/persistence, faire un addCheckIn</li>
<li>faire un getCheckIns, tester la taille de la collection et que la propriété key est apparue</li>
<li>lancer ‘npm run test‘ : ça plante sur ‘Cannot read property 'ajax' of undefined‘ . On va simuler tout jQuery avec cheerio + rajouter Backbone Mediator</li>
<li>avancer l'horloge d'une milliseconde</li>
<li>faire un second addCheckIn, puis getCheckIns, test de la taille de la collection</li>
<li>tester que le dernier checkIn ajouté (index 0) a sa key === la première key + 1</li>
<li>ATTENTION BUG sinon et node: si après des consoles de Date.now la date n'avance pas, utiliser +new Date à la place</li>
<li>tester que ça fail en remplaçant par exemple dans persistence/@addCheckIn Date.now() par un _.random(0, 10000) (ce qui évite que Kevin le stagiaire change cette ligne)</li>
</ul>
<p>But 2 : Test d'interface : l'horloge qui se me à jour toute seule</p>
<ul>
<li>exécuter test-phantomjs/home_view_spec.html</li>
<li>créer test-phantomjs/home_view_spec.js depuis collection_spec.js</li>
<li>enlever require(chai) et chai.should() (déjà dans le html), et laisser 2 it()</li>
<li>annonce qu'on veut rendre la vue home_view : @beforeEach require views/home_view et new HomeView.render()</li>
<li>regarder les erreurs, implémenter le code du @before</li>
<li>implémenter à la suite + le .restore dans afterEach :</li>
<li><ul>
<li>stub de prompt (regarder sessionStorage)</li>
</ul>
</li>
<li><ul>
<li>stub de socket.io,</li>
</ul>
</li>
<li><ul>
<li>fakeServer.create()</li>
</ul>
</li>
<li><ul>
<li>clock useFakeTimer</li>
</ul>
</li>
<li>récupérer l'heure : Date.now() =&gt; 1421965831064 puis dans la console require('moment')(1421965831064).format('dddd D MMMM YYYY HH:mm:ss')</li>
<li>au passage ouvrir le débat : est ce que je hardcode le jour ou est ce que j'utilise moment ? test = certitude, on hardcode</li>
<li>test 1 (statique)</li>
<li>test 2 (dynamique, avec le tick)</li>
</ul>
<p>montrer que le navigateur c'est cool mais qu'on peut aussi en avoir un en CLI : mocha-phantomjs test-phantomjs/home_view_spec.html</p>
</aside>
          </section>

          <section id="sinon-server" class="future" style="top: -20px; display: none;">
            <h1>Pas besoin du serveur</h1>

            <p>Tester le client en isolation, sans serveur&nbsp;!</p>
            <p>Au top pour tester les cas d’erreur et isoler du serveur effectif.</p>

            <pre><code data-trim="" data-noescape="" class="javascript" data-file="test-phantomjs/persistence_spec.js">xhr = sinon.<u>fakeServer.create</u>();

<span class="comment">// …</span>

<span class="keyword">var</span> req = _(xhr.<u>requests</u>).findWhere({ method: <span class="string">'POST'</span> });
req.<u>respond</u>(<span class="number">201</span>, { <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span> }, <span class="string">'{"id":42}'</span>);

<span class="comment">// …</span>

xhr.<u>restore</u>();</code></pre>
            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>but : tester le merge des données revenant du serveur avec le cache local</p>
<ul>
<li>créer test-phantomjs/persistence_spec.html en copiant/collant home_view_spec.html . Seule modification : inclusion de persistence_spec.js</li>
<li>création de persistence_spec.js en copiant / collant test/persistence_spec.js.</li>
<li>Supprimer require(chai) et require(sinon)</li>
<li>supprimer le fake Backbone.$.ajax</li>
<li>remplacer cheerio par jquery</li>
<li>ajouter require de underscore</li>
<li>supprimer le contenu du it() et du beforeEach(), changer le texte</li>
<li>dans la console chrome, voir les erreurs de XHR cross origine</li>
<li>dans beforeEach sinon.fakeServer.create , store = require(lib/persistence), localStorage.clear()</li>
<li>afterEach : xhr.restore()</li>
<li>test :</li>
<li><ul>
<li>ajout à la collection (store.addCheckIn)</li>
</ul>
</li>
<li><ul>
<li>on vérifie que la requête à notre serveur virtuel est in-flight : check si la liste des pendings === 1</li>
</ul>
</li>
<li><ul>
<li>cohérence des données dans les pending et les requêtes in-flight (xhr.requests)</li>
</ul>
</li>
<li><ul>
<li>fake réponse avec code 201 et id 42</li>
</ul>
</li>
<li><ul>
<li>on vérifie que les pendings sont revenus à 0</li>
</ul>
</li>
</ul>
</aside>
          </section>

          <section id="testing-automation" class="future" style="top: -20px; display: none;">
            <h1>Automatiser les navigateurs</h1>

            <p><a href="http://seleniumhq.org/">Selenium</a></p>
            <p><a href="http://karma-runner.github.io/">Karma</a></p>
            <p><a href="http://phantomjs.org/">PhantomJS</a> et <a href="http://slimerjs.org/">SlimerJS</a></p>
            <p><a href="http://casperjs.org/">CasperJS</a>, <a href="https://github.com/jonleighton/poltergeist">Poltergeist</a>…</p>
            <p>(et le harnais/serveur <a href="https://github.com/creativelive/spook">Spook</a>)</p>

            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>Selenium :</p>
<ul>
<li>20 ans, par Saucelabs</li>
<li>TOUS les navigateurs</li>
<li>simule TOUT : prompt, upload, screenshot, saisie progressive de texte, réglages utilisateur …</li>
<li>langage de script propre</li>
<li>mais Selenium RC = connecteurs pour le piloter</li>
<li>un paquet de VMs</li>
</ul>
<p>Karma :
<em> ex testacular
</em> concurrent direct Selenium
<em> moins de features
</em> pas IE !</p>
<p>Phantom / Slimer :
<em> webkit (équivalent chrome 22 + V8) ou gecko
</em> solide, rapide
<em> screenshot, navigation, exécution de JS dans la page
</em> manque certaines actions comme drag/drop
*</p>
<p>TrifleJS :</p>
<ul>
<li>IE headless (en pratique v8 + WebComponent de la CLR, mais plutôt bien équivalent, au final).</li>
<li>IE récent donc, un jour</li>
</ul>
<p>CasperJS :</p>
<ul>
<li>pilote Phantom, slimer et trifle</li>
<li>API bcp + lisible</li>
<li>pilotable depuis NodeJS avec SpookyJS</li>
</ul>
<p>Casper 2
<em> sera un vrai module Node
</em> API async en promise</p>
<p>Poltergeist en Ruby</p>
<p>Faire une démo de CasperJS basée sur 3 exemples :
<a href="https://github.com/n1k0/casperjs/blob/master/samples/googlelinks.js">Google Links</a>,
<a href="https://github.com/n1k0/casperjs/blob/master/samples/screenshot.js">Screenshot</a> (changer le sélecteur à <code>.js-stream-item</code>, si ça bloque) et
<a href="https://gist.github.com/n1k0/5477539">Google Suggest</a> (s'il remarche…)</p>
<p>Indiquer que la combo Mocha + CasperJS, qui nécessite encore un peu de tripatouillages mais sera bientôt fluidifiée, constitue une solution de référence ces temps-ci pour des tests d'inté <em>headless</em> donc en CI…</p>
</aside>
          </section>

          <section id="mocha-phantomjs" class="future" style="top: -20px; display: none;">
            <h1>Mocha-PhantomJS</h1>
            <p>Bridge prédéfini permettant d’exécuter mocha aussi bien dans un navigateur, interactivement, que dans un PhantomJS</p>

            <pre><code data-trim="" data-noescape="" class="javascript" data-file="test-phantomjs/persistence_spec.html">&lt;div id=<span class="string">"mocha"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<u><span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"../node_modules/mocha/mocha.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></u>
<span class="tag">&lt;<span class="title">script</span>&gt;</span><u><span class="javascript">mocha.ui(<span class="string">'bdd'</span>).reporter(<span class="string">'html'</span>).slow(<span class="number">250</span>);</span></u><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"../public/app.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"./persistence_spec.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
<span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript">
<u><span class="keyword">if</span> (window.mochaPhantomJS) { mochaPhantomJS.run(); }
<span class="keyword">else</span> { mocha.run(); }</u>
</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span></code></pre>

            <pre><code data-trim="" data-noescape="" class="no-highlight"><span class="prompt">$ mocha-phantomjs test-phantomjs/persistence_spec.html</span>

  The persistence layer
    <span class="green">✓</span> <span class="gray">should properly merge sync-based data in the local cache</span>

  <span class="green">1 passing</span> <span class="gray">(31ms)</span></code></pre>
            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>BUG : ça ne marche pas
mocha-phantomjs persistence_spec.html</p>
</aside>
          </section>

          <section id="testing-paas" class="future" style="top: -20px; display: none;">
            <h1>Les VM en PaaS</h1>

            <p><a href="http://www.browserstack.com/">Browserstack</a> (et <a href="http://modern.ie/">modern.ie</a>)</p>
            <p><a href="https://saucelabs.com/">SauceLabs</a>*</p>

            <footer>* À la main avec
              <a href="https://saucelabs.com/javascript/">JS Unit Testing on Sauce</a>,
              <a href="https://saucelabs.com/javascript/mocha-js">Mocha JS on Sauce</a>,
              <a href="https://docs.saucelabs.com/tutorials/node-js/">Node.js on Sauce</a>,
              <a href="https://docs.saucelabs.com/reference/rest-api/">l’API REST</a>,
              ou (en théorie…)
              <a href="https://github.com/pbakaus/mocha-sauce">mocha-sauce</a>.
              Mais aussi via Karma avec
              <a href="https://github.com/karma-runner/karma-sauce-launcher">karma-sauce-launcher</a>, ou via <a href="http://theintern.io/">Intern</a>…
            </footer>

            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>Pour avoir rapidement des versions très spécifiques :</p>
<ul>
<li>SauceLabs et BrowserStack</li>
<li>SauceLabs au niveau scripting a l'air plus robuste. forfait unique pour les usages manuel et auto, enregistrement vidéo de l'auto</li>
<li>BrowserStack : 30 mn grauites pour de l'interactif</li>
<li>mobiles dans simulateur</li>
<li>Saucelabs : pilotable via tout langage</li>
</ul>
</aside>
          </section>
        </section>

        <section id="documenting" hidden="" class="stack future" style="top: 0px; display: block;">
          <section class="chapter" style="top: -137px; display: block;">
            <h1>Documenter</h1>
            <h4>Les autres c’est toi dans 6 mois</h4>
          </section>

          <section id="doc-jsdoc" class="future" style="top: -20px; display: none;">
            <h1>Traditionnel</h1>

            <p><a href="http://usejsdoc.org/">JSDoc 3</a></p>
            <p>Façon Javadoc&nbsp;: commentaires spéciaux, tags…</p>
            <p><a href="http://yui.github.com/yuidoc/">YUIDoc</a> est similaire mais plus moderne, et avec un mode serveur/watcher.</p>

            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>classique :</p>
<ul>
<li>format connu (@param …)</li>
<li>va très loin (dépendances, formatage)</li>
<li>gros effort de mise en forme de la part de l'équipe</li>
<li>souvent fastidieux à faire et lire</li>
</ul>
</aside>
          </section>

          <section id="doc-docco" class="future" style="top: -20px; display: none;">
            <h1>Literate</h1>

            <p><a href="http://jashkenas.github.com/docco/">Docco</a> / <a href="http://nevir.github.io/groc/">Groc</a></p>
            <p>(démo sur le code final de la SPA)</p>

            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>Source annoté :</p>
<ul>
<li>facile à installer (npm, watch)</li>
<li>facile à maintenir (commentaires dans le code)</li>
<li>Markdown, syntax highlighter, double colonne</li>
<li>utilisé par backbone et underscore</li>
<li>groc est une évolution de docco</li>
</ul>
<p>Toujours utile, facile à mettre en œuvre.  Démo avec un appel <code>docco.sh</code> à la racine de <code>spa-final</code> (à migrer vers une config Groc…)</p>
<ul>
<li>npm install -g groc</li>
<li>groc</li>
<li>montrer le fichier .groc.json</li>
</ul>
</aside>
          </section>

          <section id="doc-hosting" class="future" style="top: -20px; display: none;">
            <h1>Hébergement des docs</h1>

            <p><a href="http://readthedocs.org/">readthedocs.org</a></p>
            <p>Public / protégé / privé</p>
            <p>Github / Bitbucket / Webhooks</p>
            <p>Versionné</p>
            <p>slugs/rtfd.org, CNAMEs…</p>
            <p>+ <a href="https://www.google.fr/search?q=site%3Amedia.readthedocs.org+filetype%3Apdf">PDF</a> + manpages</p>

            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>La démo ultime : <a href="http://docs.casperjs.org/en/latest/">docs de Casper</a>.  Thèmes, exports PDF/ePub, recherche, versioning, images, colorisation syntaxique, etc.</p>
<p>Hélas pas basé sur du source annoté ou même du Markdown mais sur le moteur de documentation Sphinx (format puissant ceci dit).</p>
</aside>
          </section>
        </section>

        <section id="mobile" hidden="" class="stack future" style="top: 0px; display: block;">
          <section class="chapter" style="top: -137px; display: block;">
            <h1>Et sur mobile&nbsp;?</h1>
            <h4>Le nouveau web c’est lui</h4>
          </section>

          <section id="mobile-constraints" class="future" style="top: -243.5px; display: block;">
            <h1>Contraintes</h1>

            <p>Cool&nbsp;: «&nbsp;HTML5&nbsp;» (CSS3, WebSockets, localStorage…)</p>
            <p>Dimensions d’image (max 1000 × 1000)</p>
            <p>Cache classique (max 25Ko/fichier, pré-GZip)</p>
            <p>Appcache (tout sauf la vidéo)</p>
            <p>Canaux de chargement (2–6 suivant le réseau)</p>
          </section>

          <section id="mobile-ux" class="future" style="top: -270px; display: block;">
            <h1>UX homogène</h1>

            <p>User scaling &amp; <a href="https://developer.mozilla.org/fr/docs/Mobile/Viewport_meta_tag">viewport</a> (initial + modifiable)</p>
            <p><a href="http://mir.aculo.us/2013/01/26/why-and-how-to-not-use-hover-styles-on-touch-devices/">Pas de survol</a></p>
            <p>Événements tactiles</p>
            <p><a href="http://smus.com/mouse-touch-pointer/">pointer.js</a> et les <a href="https://github.com/Polymer/PointerEvents">Pointer Events</a></p>
            <p><a href="http://www.w3.org/TR/2013/WD-pointerevents-20130115/#the-touch-action-css-property">Tactile en contexte mixte</a></p>
            <p><a href="http://www.w3.org/TR/mwabp/">Meilleures pratiques du W3C</a></p>
          </section>

          <section id="mobile-rwd" class="future" style="top: -207px; display: block;">
            <h1>Quelle adaptation&nbsp;?</h1>

            <p>Media Queries &amp; Responsive Web Design (RWD)… jusqu'à un certain point (ça peut quand même aller loin)</p>
            <p>Une qualité d'UX et de BP 100% optimale nécessitera souvent des UIs distinctes :-/</p>
          </section>

          <section id="mobile-webapp" class="future" style="top: -20px; display: none;">
            <h1>Mobile Web Apps</h1>

            <p>Les meta dédiées
              (<a href="http://speckyboy.com/2012/05/16/creating-a-mobile-web-application-with-meta-tags/">ici</a> et
              <a href="http://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html">ici</a>)
            </p>
            <p><a href="http://www.html5rocks.com/en/mobile/mobifying/">Plein d'autres astuces</a></p>
            <p>Add to Home Screen (pénible sur Android)</p>
            <p>Applis hybrides light (juste une WebView, tout online) et lourdes (tout embarqué)</p>
            <p><a href="http://phonegap.com/">Phonegap</a> / <a href="http://cordova.apache.org/">Cordova</a></p>
            <p><a href="http://www.mozilla.org/fr/firefoxos/">Firefox OS</a> et le futur…</p>
          </section>
        </section>

        <section id="optimizing" hidden="" class="stack future" style="top: 0px; display: block;">
          <section class="chapter" style="top: -163.5px; display: block;">
            <h1>Optimiser</h1>
            <h4>Load, Parse, Run, Render</h4>

            <p><a href="http://fr.slideshare.net/jpvincent/introduction-a-la-webperf">Pourquoi aller vite ?</a></p>
          </section>

          <section id="loading-weight-1" class="future" style="top: -338.5px; display: block;">
            <h1>Chargement</h1>

            <h3>Desktop vs. mobile</h3>
            <p>De 6 à 13 canaux par <abbr title="Fully-Qualified Domain Name">FQDN</abbr></p>

            <h3>Critical Path</h3>
            <p>Limiter les bloquants (CSS <a href="https://www.youtube.com/watch?v=FEs2jgZBaQA">critique</a> <em>inlinée</em> en head, JS critique en bas du body, pourquoi pas sur le même FQDN que la page)</p>

            <h3>Concaténation</h3>

            <p>Des scripts et CSS (<a href="http://brunch.io/">Brunch</a>, <a href="http://browserify.org/">Browserify</a>, <a href="http://requirejs.org/docs/optimization.html">r.js</a>) — Penser à contextualiser</p>

            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>chargement JS asynchrone justifié dans certains cas (pages très lourdes, modulaire). Voire CSS (facebook)</p>
</aside>
          </section>

          <section id="loading-weight-2" class="future" style="top: -350px; display: block;">
            <h1>Chargement</h1>

            <h3>Spriting, fontes icôniques</h3>

            <p>Avec <a href="http://glue.readthedocs.org/en/latest/">Glue</a>, <a href="http://fortawesome.github.io/Font-Awesome/">Font Awesome</a>, et tuning via <a href="http://icomoon.io/app/">l'app Icomoon</a></p>

            <h3>Minification / opti images</h3>

            <p>Des scripts (<a href="http://lisperator.net/uglifyjs/">UglifyJS</a>) et CSS (<a href="https://github.com/jakubpawlowicz/clean-css">Clean-CSS</a>), des images (<a href="http://imageoptim.com/">ImageOptim</a>, etc.) et notamment grosses photos JPEG (<a href="http://www.jpegmini.com/">JPEGmini</a>).</p>

            <h3>Compression (gzipping)</h3>

            <p>Avec <a href="http://www.feedthebot.com/pagespeed/enable-compression.html">Apache, nginx</a>, <a href="http://technet.microsoft.com/en-us/library/cc771003%28WS.10%29.aspx">IIS</a>…  Et notamment le <a href="http://nginx.org/en/docs/http/ngx_http_gzip_static_module.html">gzip statique</a>. Et <a href="http://www.html5rocks.com/fr/tutorials/speed/txt-compression/">lisez ça</a>&nbsp;!</p>

            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>Glue : générateur, à partir de fichiers, de sprites + css associé</p>
<p>démo imageOptim, à partir d'images du bureau, montrer les exe dans preferences pendant que ça optimise, avec la charge proc à côté.</p>
<p>jpgemini avec l'image du bureau</p>
<p>ex: jquery original : 300Ko =&gt; minifié =&gt; 90Ko =&gt; gzipé =&gt; 32.5Ko</p>
</aside>
          </section>

          <section id="loading-weight-3" class="future" style="top: -20px; display: none;">
            <h1>Chargement</h1>

            <h3>Cache HTTP</h3>

            <p>Utilisez correctement <code>Last-Modified</code> et <code>If-Modified-Since</code>, <code>Max-Age</code>, <code>E-Tag</code>, <code>Pragma</code> et <code>Cache-Control</code>, les codes de retour 304…  <a href="http://www.mnot.net/cache_docs/">Apprenez ça une bonne fois</a>.</p>

            <h3>Cookieless asset hosting…</h3>

            <p>Servez vos assets statiques depuis des FQDN sans cookies. <code>assets.monsite.fr</code> ou <code>assets-monsite.fr</code>.</p>

            <h3>…voire CDN</h3>

            <p><a href="http://aws.amazon.com/fr/s3/">S3</a> / <a href="http://aws.amazon.com/fr/cloudfront/">CloudFront</a>, <a href="https://www.fastly.com/">fastly</a>…</p>

            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>les devs n'aiment pas gérer le cache, marre du "vide ton cache"</p>
<p>technique idéale en PROD : cache long, gestion fine des URLs</p>
<p>parler de la technique de MAJ JS de GMaps</p>
</aside>
          </section>

          <section id="loading-loaders" class="future" style="top: -20px; display: none;">
            <h1>Chargement</h1>
            <h4>Parallélisation</h4>

            <h3>Synchrone vs. asynchrone</h3>

            <p>Les synchrones (balise <code>script</code> dans le HTML servi de base) sont bloquants</p>

            <h3>JS tierce-partie</h3>

            <p>Fuyez tout ce qui <code>document.write</code>&nbsp;!</p>

            <h3>Loaders vs. concaténation</h3>

            <p>La concaténation gagne pratiquement toujours.</p>
            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>Loader async, CSS compris : technique facebook</p>
</aside>
          </section>

          <section id="loading-loaders-2" class="future" style="top: -20px; display: none;">
            <h1>Chargement</h1>
            <h4>Parallélisation</h4>

            <h3><a href="https://developer.mozilla.org/fr/docs/FAQ_sur_le_pr%C3%A9chargement_des_liens">Prefetching</a></h3>

            <p>Pour des chemins de navigation ultra-dominants.</p>

            <h3><a href="http://appcache.offline.technology/">AppCache</a></h3>

            <p>Pour charger une tonne une bonne fois, et être tranquilles ensuite…</p>
            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>Attributs rel= prefetch et prerender. Généralement plutôt fait main =&gt; technique Yahoo! mail</p>
</aside>
          </section>

          <section id="parsing" class="future" style="top: -20px; display: none;">
            <h1>Parsing</h1>

            <h3>CSS</h3>

            <p>Gare aux sélecteurs mal optimisés et aux <a href="https://www.youtube.com/watch?v=FEs2jgZBaQA">règles inutiles</a></p>

            <h3>Images</h3>

            <p>Optimisez les dimensions d'origine (vignettes, etc.) et précisez les dimensions dans la page (HTML ou CSS) pour éviter un double-rendering.</p>

            <h3>DOM</h3>

            <p>Restez sveltes.  Apprenez à maîtriser le <a href="https://developer.mozilla.org/fr/docs/CSS/Mod%C3%A8le_de_bo%C3%AEte">Box Model</a> (et pourquoi pas <a href="http://css-tricks.com/snippets/css/a-guide-to-flexbox/">flexbox</a>) et fuyez la <a href="http://fr.wiktionary.org/wiki/divitis">divitis</a>.</p>

            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>Montrer DOM Monster</p>
</aside>
          </section>

          <section id="runtime-js" class="future" style="top: -20px; display: none;">
            <h1>Exécution JS</h1>
            <h4>Optis de langage pur</h4>

            <p>Loop invariants</p>
            <p>Memoization</p>
            <p>RegExp caching</p>
            <p>Recyclage de tableaux</p>
            <p>Comparaisons strictes</p>

            <aside class="notes" data-markdown="" data-markdown-parsed="true"></aside>
          </section>

          <section id="runtime-dom" class="future" style="top: -20px; display: none;">
            <h1>Manips DOM</h1>
            <h4>Patterns et anti-patterns</h4>

            <p>Réduire la taille au maximum</p>
            <p>Optimisation des sélecteurs</p>
            <p>Lookup caching</p>
            <p>Event delegation</p>
            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>$('.element') =&gt; var container = $('#module-container'); container.find('.element'); au pire $('#module-container &gt; li.element');</p>
<p>Génération de DOM : un insert massif plutôt plein de petites modifications</p>
<p>delegation : $('#container li').on('click', function(){}) =&gt; $('#container').on('click', 'li', function(){});</p>
</aside>
          </section>

          <section id="runtime-timing" class="future" style="top: -20px; display: none;">
            <h1>Exécution périodique</h1>
            <h4>Faire confiance au navigateur</h4>

            <p><code>setTimeout</code> &amp; <code>setInterval</code></p>
            <p><code>requestAnimationFrame</code>&nbsp;!</p>

            <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>démo avec setTimeout(0).html</p>
</aside>
          </section>

          <section id="runtime-workers" class="future" style="top: -20px; display: none;">
            <h1>Parallélisation JS</h1>
            <h4>Des workers quand il faut</h4>

            <p class="fragment" data-fragment-index="0">JS est mono-thread</p>
            <p class="fragment" data-fragment-index="1">Je répète&nbsp;: JS est mono-thread</p>
            <p class="fragment" data-fragment-index="2"><strong>sauf que…</strong></p>
            <p class="fragment" data-fragment-index="3">…on a les Web Workers</p>
            <p class="fragment" data-fragment-index="4">Y’a des gros garde-fous</p>
            <p class="fragment" data-fragment-index="5">Cas d’utilisation classiques</p>
          </section>

          <aside class="notes" data-markdown="" data-markdown-parsed="true"><p>supporté par IE10, FF, chrome, iOS 5, android 4.4</p>
<p>polyfill à base de setTimeout 0 =&gt; ie-web-worker</p>
</aside>
        </section>

        <section id="conclusion" hidden="" class="stack future" style="top: 0px; display: block;">
          <section class="chapter" style="top: -137px; display: block;">
            <h1>Conclusion</h1>
            <h4>Les meilleures choses ont une fin</h4>
          </section>

          <section id="conclusion-wrapup" class="future" style="top: -270px; display: block;">
            <h1>En résumé…</h1>

            <p>Web front == <strong>power</strong></p>
            <p>Écosystème de plus en plus riche</p>
            <p>Essor des applis riches côté client</p>
            <p>Ça va vite se passer surtout sur mobile</p>
            <p>JS == langage n°1</p>
            <p>Y’a quand même de quoi s’éclater…</p>
          </section>

          <section id="thank-you" class="future" style="top: -20px; display: none;">
            <h1>Merci&nbsp;!</h1>

            <p><a href="http://www.js-attitude.fr/">http://www.js-attitude.fr/</a></p>
            <p><a href="http://twitter.com/jsattitude">@jsattitude</a></p>
          </section>
        </section>
      </div>
    <div class="backgrounds"><div class="slide-background present"></div><div class="slide-background future"></div><div class="slide-background future"><div class="slide-background present"></div><div class="slide-background future"></div><div class="slide-background future"></div><div class="slide-background future"></div><div class="slide-background future"></div><div class="slide-background future"></div><div class="slide-background future"></div><div class="slide-background future"></div><div class="slide-background future"></div><div class="slide-background future"></div></div><div class="slide-background future"><div class="slide-background present"></div><div class="slide-background future"></div><div class="slide-background future"></div><div class="slide-background future"></div></div><div class="slide-background future"><div class="slide-background present"></div><div class="slide-background future"></div><div class="slide-background future"></div><div class="slide-background future"></div><div class="slide-background future"></div></div><div class="slide-background future"><div class="slide-background present"></div><div class="slide-background future"></div><div class="slide-background future"></div><div class="slide-background future"></div><div class="slide-background future"></div><div class="slide-background future"></div><div class="slide-background future"></div><div class="slide-background future"></div><div class="slide-background future"></div><div class="slide-background future"></div><div class="slide-background future"></div></div><div class="slide-background future"><div class="slide-background present"></div><div class="slide-background future"></div><div class="slide-background future"></div></div></div><div class="progress" style="display: block;"><span style="width: 0px;"></span></div><aside class="controls" style="display: block;"><div class="navigate-left"></div><div class="navigate-right enabled"></div><div class="navigate-up"></div><div class="navigate-down"></div></aside><div class="slide-number"></div><div class="pause-overlay"></div></div>

    <script src="./JS Total • 4ème partie, 11_12_2015_files/head.min.js"></script>
    <script src="./JS Total • 4ème partie, 11_12_2015_files/reveal.min.js"></script>

    <script>
      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

        // Parallax scrolling
        // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
        // parallaxBackgroundSize: '2100px 900px',

        // Optional libraries used to extend on reveal.js
        dependencies: [
          { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
        ]
      });
    </script><script type="text/javascript" src="./JS Total • 4ème partie, 11_12_2015_files/marked.js"></script><script type="text/javascript" src="./JS Total • 4ème partie, 11_12_2015_files/markdown.js"></script>
  

<script type="text/javascript" src="./JS Total • 4ème partie, 11_12_2015_files/highlight.js"></script><script type="text/javascript" src="./JS Total • 4ème partie, 11_12_2015_files/notes.js"></script></body></html>